<tool id="recetox_xmsannotator_simple" name="xmsannotator - simple" version="{{tool_version}}">
    <macros>
        <import>recetox_xmsannotator_macros.xml</import>
    </macros>

    <expand macro="requirements"/>

    <command detect_errors="aggressive"><![CDATA[
        Rscript -e 'annotation <- xmsannotator::simple_annotation(
                        peaks = arrow::read_feather("$peaks"),
                        adducts = rhdf5::h5read("$adducts", "adducts"),
                        metabolites = rhdf5::h5read("$metabolites", "metabolites"),
                        mz_tolerance = as.double($mass_tolerance)
                   )'
                -e 'arrow::write_feather(annotation, "$annotation")'
    ]]></command>

    <inputs>
        <param name="peaks" type="data" format="feather" label="Peaks" help="Table of peak intensities."/>
        <param name="metabolites" type="data" format="h5" label="Metabolite database"/>
        <param name="adducts" type="data" format="h5" label="Adduct database"/>

        <param name="mass_tolerance" type="float" value="10" min="0" label="Mass tolerance [ppm]" help="Mass tolerance in ppm for database matching."/>
    </inputs>

    <outputs>
        <data format="feather" name="annotation"/>
    </outputs>

    <help><![CDATA[]]></help>
    <expand macro="citations"/>
</tool>