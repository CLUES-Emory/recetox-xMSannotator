<tool id="xmsannotator_simple" name="Simple Annotation" version="0.0.0.1">
    <requirements>
        <container type="docker">
            registry.gitlab.ics.muni.cz:443/recetox/mass-spectrometry/xmsannotator:0.0.0.1
        </container>
    </requirements>

    <command><![CDATA[
        Rscript
            -e 'result <- xMSannotator::simpleAnnotation(
                dataA=readRDS($input),
                db_name="$db_name",
                max.mz.diff=$max_mz_diff,
                queryadductlist=$query_adducts,
                gradienttype="$gradient_type",
                mode="$ionization_mode"
                outloc=getwd())'
            -e 'saveRDS(data, file=$output)'
    ]]></command>

    <inputs>
        <param name="input" type="data" format="rdata" label="Peak intensity table"
               help="The peak intensity table that we want to annotate. The first two columns should be mz and time followed by sample intensities. The missing intensities should be marked by NA value."/>

        <param name="db_name" type="select" display="radiobutton" label="Metabolite database"
               help="Pick a database for metabolite annotation.">
            <option value="HMDB" selected="true">HMDB</option>
            <option value="">KEGG</option>
            <option value="T3DB">T3DB</option>
            <option value="LipidMaps">LipidMaps</option>
        </param>

        <param name="max_mz_diff" type="integer" value="10" min="0" label="Mass tolerance [ppm]"
               help="Mass tolerance in ppm for database matching."/>

        <param name="query_adducts" type="select" multiple="true" label="Adducts" help="">
            <option value="all">All</option>
            <!-- TODO -->
        </param>

        <param name="ionization_mode" type="select" display="radiobutton" label="Ionization mode"
               help="Narrow the selection of the searched adducts by ionization mode.">
            <option value="pos" selected="true">positive</option>
            <option value="neg">negative</option>
        </param>

        <param name="gradient_type" type="select" label="Gradient type"
               help="Narrow the selection of the searched adducts by gradient type.">
            <option value="Acetonitrile" selected="true">Acetonitrile</option>
        </param>
    </inputs>

    <outputs>
        <data name="output" format="rdata"/>
    </outputs>
</tool>